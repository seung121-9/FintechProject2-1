<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.reservation">
	
	<resultMap type="payDTO" id="payResult">
		<result property="reservation_id" column="reservation_id"></result>
		<result property="id" column="id"></result>
		<result property="accommodation_id" column="accommodation_id"></result>
		<result property="checkin_date" column="checkin_date"></result>
		<result property="checkout_date" column="checkout_date"></result>
		<result property="phonenumber" column="phonenumber"></result>
		<result property="guest_count" column="guest_count"></result>
		<result property="total_price" column="total_price"></result>
	</resultMap>

	<delete id="delReservation" parameterType="string">
       delete from pay where reservation_id = #{reservation_id}
    </delete>
	<insert id="addPay" parameterType="payDTO">
		INSERT INTO pay
		(accommodation_id, id, reservation_id, checkin_date, checkout_date, guest_count,
		total_price)
		VALUES
		(#{accommodation_id},#{id}, #{reservation_id},
		#{checkin_date}, #{checkout_date},
		#{guest_count}, #{total_price})
	</insert>
	<select id="payList" resultMap="payResult">
		select * from pay order by
		reservation_id desc
	</select>
	<select id="reservationGetUserId" parameterType="string" resultType="payDTO">
SELECT
    p.reservation_id,
    p.id,
    p.accommodation_id,
    a.accommodation_name, -- 숙소 이름 추가
    p.checkin_date,
    p.checkout_date,
    p.guest_count,
    p.total_price
FROM
    pay p
JOIN
    accommodation a ON p.accommodation_id = a.accommodation_id
WHERE
    p.id = #{loginId}
</select>
	
	
</mapper> 